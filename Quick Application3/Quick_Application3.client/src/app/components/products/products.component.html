<header class="pageHeader">
  <h3><i class="fa fa-truck fa-lg page-caption" aria-hidden="true"></i> {{ 'pageHeader.Products' | translate }}</h3>
</header>

<div class="boxshadow">
  <h2>Search Products</h2>
  <div class="row g-3">
    <div class="col-md-12">
      <div class="input-group">
        <select class="form-select" style="max-width: 150px;" [(ngModel)]="searchType">
          <option value="name">Search by Name</option>
          <option value="id">Search by ID</option>
        </select>
        <input 
          [type]="searchType === 'id' ? 'number' : 'text'"
          class="form-control"
          [(ngModel)]="searchTerm"
          [placeholder]="searchType === 'name' ? 'Enter product name' : 'Enter product ID'"
          (input)="searchType === 'name' ? search() : null"
        />
        <button 
          class="btn btn-primary"
          (click)="search()"
          [disabled]="!searchTerm">
          Search
        </button>
      </div>
    </div>
  </div>
</div>


<div *ngIf="filteredProducts.length > 0; else noProducts">
  <table class="table table-striped table-hover mt-3 boxshadow">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Description</th>
        <th>Buying Price</th>
        <th>Selling Price</th>
        <th>Units in Stock</th>
        <th>Active</th>
        <th>Discontinued</th>
        <th>Category</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of filteredProducts">
        <td>{{ product.id }}</td>
        <td>{{ product.name }}</td>
        <td>{{ product.description }}</td>
        <td>${{ product.buyingPrice }}</td>
        <td>${{ product.sellingPrice }}</td>
        <td>{{ product.unitsInStock }}</td>
        <td>{{ product.isActive ? 'Yes' : 'No' }}</td>
        <td>{{ product.isDiscontinued ? 'Yes' : 'No' }}</td>
        <td>{{ product.productCategoryName }}</td>
      </tr>
    </tbody>
  </table>
</div>

<ng-template #noProducts>
  <p>No products available</p>
</ng-template>


<div class="boxshadow mt-4 p-3">
  <h3>Add New Product</h3>
  <form [formGroup]="productForm" (ngSubmit)="addProduct()" class="row g-3">
    <div class="col-md-6">
      <label class="form-label">Name</label>
      <input class="form-control" formControlName="name" required />
      <small class="text-danger" *ngIf="productForm.get('name')?.touched && productForm.get('name')?.invalid">
        Name is required
      </small>
    </div>

    <div class="col-md-6">
      <label class="form-label">Description</label>
      <input class="form-control" formControlName="description" />
    </div>

    <div class="col-md-4">
      <label class="form-label">Buying Price</label>
      <input class="form-control" type="number" formControlName="buyingPrice" required min="0" />
      <small class="text-danger" *ngIf="productForm.get('buyingPrice')?.touched && productForm.get('buyingPrice')?.invalid">
        Valid buying price is required
      </small>
    </div>

    <div class="col-md-4">
      <label class="form-label">Selling Price</label>
      <input class="form-control" type="number" formControlName="sellingPrice" required min="0" />
      <small class="text-danger" *ngIf="productForm.get('sellingPrice')?.touched && productForm.get('sellingPrice')?.invalid">
        Valid selling price is required
      </small>
    </div>

    <div class="col-md-4">
      <label class="form-label">Units in Stock</label>
      <input class="form-control" type="number" formControlName="unitsInStock" required min="0" />
      <small class="text-danger" *ngIf="productForm.get('unitsInStock')?.touched && productForm.get('unitsInStock')?.invalid">
        Valid units in stock is required
      </small>
    </div>

    <div class="col-md-4">
      <label class="form-label">Category</label>
      <input class="form-control" formControlName="productCategoryName" />
    </div>

    <div class="col-md-4">
      <div class="form-check mt-4">
        <input class="form-check-input" type="checkbox" formControlName="isActive" id="isActive">
        <label class="form-check-label" for="isActive">Active</label>
      </div>
    </div>

    <div class="col-md-4">
      <div class="form-check mt-4">
        <input class="form-check-input" type="checkbox" formControlName="isDiscontinued" id="isDiscontinued">
        <label class="form-check-label" for="isDiscontinued">Discontinued</label>
      </div>
    </div>

    <div class="col-12">
      <button type="submit" [disabled]="productForm.invalid" class="btn btn-success">Create Product</button>
    </div>
  </form>
</div>
